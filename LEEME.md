# Gatinos üêà

## Aviso del Programador

Se planea que este proyecto est√© listo para ser usado cuando se cree la aplicaci√≥n m√≥vil que la acompa√±a, mientrastanto la estoy usando para practicar las √∫ltimas t√©cnicas de programaci√≥n con LLMs a√±adiendo caracter√≠sticas y refactorizando.

**Sistema Avanzado de Gesti√≥n de Colonias Felinas**

[![Django](https://img.shields.io/badge/Django-4.2.23-green.svg)](https://www.djangoproject.com/)
[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/)
[![Vue.js](https://img.shields.io/badge/Vue.js-3.0-green.svg)](https://vuejs.org/)
[![Licencia](https://img.shields.io/badge/Licencia-MIT-yellow.svg)](LICENSE)

Gatinos es una aplicaci√≥n web integral basada en Django dise√±ada para gestionar colonias de gatos con caracter√≠sticas avanzadas para el seguimiento de gatos individuales, sus registros de salud, horarios de alimentaci√≥n y actividades de voluntarios. El sistema soporta control de acceso basado en roles y proporciona interfaces web modernas para una gesti√≥n eficiente de colonias.

## Caracter√≠sticas

### üêà Funcionalidad Principal
- **Perfiles Individuales de Gatos**: Registros completos con fotos, historial de salud y notas de comportamiento
- **Gesti√≥n de Colonias**: Organizaci√≥n de gatos por colonias geogr√°ficas con seguimiento detallado
- **Galer√≠a de Fotos**: Gesti√≥n avanzada de fotos con miniaturas autom√°ticas y procesamiento EXIF
- **Registros de Salud**: Seguimiento veterinario completo incluyendo vacunaciones y tratamientos
- **Registro de Actividades**: Grabaci√≥n detallada de alimentaci√≥n, avistamientos y actividades de cuidado
- **Calendario Interactivo**: Horario de alimentaci√≥n con Vue.js y actualizaciones en tiempo real
- **Generaci√≥n de Informes**: Informes automatizados para cuidado veterinario y estado de colonias

### üë• Roles de Usuario y Control de Acceso
- **üè• Veterinario**: Acceso m√©dico completo, vacunaciones, gesti√≥n de salud
- **ü§≤ Cuidador**: Cuidado diario, horarios de alimentaci√≥n, registro b√°sico de salud
- **üëÆ Autoridad**: Funciones administrativas, gesti√≥n de colonias, supervisi√≥n de usuarios
- **üëÅÔ∏è Visitante**: Acceso de solo lectura a informaci√≥n p√∫blica e informes

### üöÄ Caracter√≠sticas Avanzadas
- **Flujos de Estado**: Seguimiento de transiciones de estado de gatos (Libre ‚Üí Capturado ‚Üí Liberado, etc.)
- **API RPC**: Interfaz JSON-RPC moderna para integraciones externas
- **Calendario en Tiempo Real**: Horario de alimentaci√≥n interactivo con asignaciones codificadas por colores
- **Visualizaci√≥n de Datos**: Mapas de calor de actividad y gr√°ficos estad√≠sticos usando matplotlib
- **Procesamiento en Segundo Plano**: Integraci√≥n con Celery para procesamiento de im√°genes e informes
- **Soporte Multi-Colonia**: Los usuarios pueden acceder a m√∫ltiples colonias autorizadas
- **Integraci√≥n de C√≥digos QR**: Acceso r√°pido a calendarios de alimentaci√≥n v√≠a dispositivos m√≥viles
- **Exportaci√≥n iCalendar**: Integraci√≥n con calendario personal para horarios de alimentaci√≥n

## üõ†Ô∏è Stack Tecnol√≥gico

### Infraestructura Backend
- **üêç Django 4.2.23** - Framework web con interfaz de administraci√≥n personalizada
- **üêò PostgreSQL** - Base de datos principal (SQLite para desarrollo)
- **üîÑ Celery + Redis** - Procesamiento de tareas en segundo plano y cach√©
- **üìä Matplotlib** - Visualizaci√≥n de datos y gr√°ficos de actividad
- **üñºÔ∏è Pillow** - Procesamiento avanzado de im√°genes y generaci√≥n de miniaturas

### Tecnolog√≠as Frontend
- **‚ö° Vue.js 3** - Componentes reactivos para caracter√≠sticas interactivas
- **üèóÔ∏è Vite** - Herramienta moderna de construcci√≥n y servidor de desarrollo frontend
- **üìÖ v-calendar** - Biblioteca avanzada de componentes de calendario
- **üé® CSS Personalizado** - Dise√±o responsivo con variables CSS

### Librer√≠as Especializadas
- **django-viewflow** - Flujos de trabajo de m√°quina de estados para gesti√≥n del estado de gatos
- **django-modern-rpc** - Endpoints de API JSON-RPC
- **django-vite** - Integraci√≥n perfecta Django-Vite
- **icalendar** - Funcionalidad de exportaci√≥n de calendario
- **segno** - Generaci√≥n de c√≥digos QR para acceso m√≥vil
- **PyYAML** - Gesti√≥n de configuraci√≥n

## üì¶ Instalaci√≥n

### Requisitos del Sistema
- **Python 3.8+** (Se recomienda Python 3.11+)
- **Node.js 18+** (para desarrollo frontend)
- **PostgreSQL 12+** (opcional - SQLite funciona para desarrollo)
- **Redis 6+** (para tareas en segundo plano y cach√©)

### Inicio R√°pido con Docker

```bash
# Clonar el repositorio
git clone https://github.com/tu-org/gatinos.git
cd gatinos

# Construir y ejecutar con Docker
docker build -t gatinos .
docker run -p 8000:8000 gatinos
```

### Configuraci√≥n para Desarrollo

1. **Clonar y Configurar el Entorno**
   ```bash
   git clone https://github.com/tu-org/gatinos.git
   cd gatinos
   
   # Crear entorno virtual
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   ```

2. **Instalar Dependencias**
   ```bash
   # Dependencias de Python
   pip install -r requirements.txt
   
   # Dependencias del frontend
   cd frontend
   npm install
   cd ..
   ```

3. **Configurar el Entorno**
   ```bash
   # Copiar plantilla de entorno
   cp .env.example .env
   
   # Editar .env con tu configuraci√≥n
   nano .env
   ```

   **Variables de Entorno:**
   ```env
   # Configuraci√≥n Principal
   SECRET_KEY=tu-clave-super-secreta-aqui
   DEBUG=True
   TIME_ZONE=Europe/Madrid
   ALLOWED_HOSTS=localhost,127.0.0.1
   
   # Base de Datos (PostgreSQL)
   SQL_ENGINE=django.db.backends.postgresql
   SQL_DATABASE=gatinos_db
   SQL_USER=gatinos_user
   SQL_PASSWORD=contrase√±a_segura
   SQL_HOST=localhost
   SQL_PORT=5432
   
   # Configuraci√≥n de Redis
   REDIS_URL=redis://localhost:6379/0
   
   # Almacenamiento de Archivos
   MEDIA_URL=/media/
   MEDIA_ROOT=/var/www/gatinos/media/
   STATIC_URL=/static/
   STATIC_ROOT=/var/www/gatinos/static/
   
   # Configuraci√≥n de Email (opcional)
   EMAIL_HOST=smtp.gmail.com
   EMAIL_PORT=587
   EMAIL_USE_TLS=True
   EMAIL_HOST_USER=tu-email@gmail.com
   EMAIL_HOST_PASSWORD=tu-contrase√±a-app
   ```

4. **Configuraci√≥n de Base de Datos**
   ```bash
   # Ejecutar migraciones
   python manage.py migrate
   
   # Crear superusuario
   python manage.py createsuperuser
   
   # Sincronizar permisos personalizados
   python manage.py syncpermissions
   
   # Cargar datos de ejemplo (opcional)
   python manage.py loaddata gatos/fixtures/sample_data.json
   ```

5. **Servidores de Desarrollo**

   **Terminal 1 - Django:**
   ```bash
   python manage.py runserver
   ```
   
   **Terminal 2 - Frontend (para desarrollo):**
   ```bash
   cd frontend
   npm run dev
   ```
   
   **Terminal 3 - Tareas en Segundo Plano (opcional):**
   ```bash
   celery -A gatinos worker -l info
   ```

6. **Acceder a la Aplicaci√≥n**
   - **Aplicaci√≥n Principal**: http://localhost:8000
   - **Interfaz de Administraci√≥n**: http://localhost:8000/admin/
   - **Documentaci√≥n API**: http://localhost:8000/rpc/

## üéØ Gu√≠a de Uso

### Flujo de Configuraci√≥n Inicial

1. **Configuraci√≥n de Administraci√≥n**
   - Acceder al admin en `/admin/` con credenciales de superusuario
   - Crear grupos de usuarios: `cuidador`, `veterinario`, `autoridad`, `visitante`
   - Configurar permisos para cada grupo

2. **Configuraci√≥n de Colonias**
   - Crear colonias en la interfaz de administraci√≥n
   - Configurar usuarios autorizados para cada colonia
   - Configurar ajustes espec√≠ficos de colonia

3. **Gesti√≥n de Usuarios**
   - Crear cuentas de usuario v√≠a interfaz de administraci√≥n
   - Asignar usuarios a grupos apropiados
   - Otorgar permisos de acceso a colonias

### Operaciones Diarias

#### Para Cuidadores
```
1. Registrar actividades de alimentaci√≥n v√≠a calendario interactivo
2. Subir fotos de gatos y actividades de la colonia
3. Registrar avistamientos de gatos y observaciones de comportamiento
4. Actualizar informaci√≥n b√°sica de salud durante visitas
```

#### Para Veterinarios
```
1. Gestionar registros completos de salud
2. Seguimiento de calendarios de vacunaci√≥n y tratamientos
3. Registrar flujos de captura/liberaci√≥n
4. Generar informes de salud para autoridades
```

#### Para Autoridades
```
1. Monitorear salud general y poblaci√≥n de colonias
2. Generar informes para ayuntamientos u ONGs
3. Gestionar acceso de usuarios y permisos
4. Coordinar entre m√∫ltiples colonias
```

### Caracter√≠sticas Clave en Detalle

#### üìÖ Sistema de Calendario Interactivo
- **Codificaci√≥n por Colores**: Rojo (tus asignaciones), Amarillo (otros), Gris (sin asignar)
- **Actualizaciones en Tiempo Real**: Los cambios se sincronizan inmediatamente entre todos los usuarios
- **Acceso M√≥vil**: C√≥digos QR para acceso r√°pido al calendario m√≥vil
- **Opciones de Exportaci√≥n**: Formato iCal para integraci√≥n con calendario personal

#### üè• Flujo de Seguimiento de Salud
```
Registro de Gato ‚Üí Evaluaci√≥n de Salud ‚Üí Calendario de Vacunaci√≥n ‚Üí 
Registros de Tratamiento ‚Üí Monitoreo de Recuperaci√≥n ‚Üí Documentaci√≥n de Liberaci√≥n
```

#### üìä Visualizaci√≥n de Datos
- **Mapas de Calor de Actividad**: Representaci√≥n visual de patrones de actividad de colonias
- **Estad√≠sticas de Salud**: Tasas de vacunaci√≥n, resultados de tratamientos
- **Tendencias de Poblaci√≥n**: Crecimiento/disminuci√≥n de colonias en el tiempo
- **Contribuciones de Usuarios**: Seguimiento de actividad de voluntarios individuales

## üîå Referencia de API

### Endpoints RPC

La aplicaci√≥n proporciona endpoints JSON-RPC en `/rpc/`:

#### Gesti√≥n de Calendario
```javascript
// Alternar asignaci√≥n de alimentaci√≥n
{
  "method": "toggle_feeding_date",
  "params": {
    "date_str": "2024-01-15",
    "colonia_id": 1,
    "current_color": "none"
  }
}

// Obtener horario de alimentaci√≥n
{
  "method": "get_feeding_dates", 
  "params": {
    "colonia_id": 1,
    "start_date": "2024-01-01",
    "end_date": "2024-01-31"
  }
}
```

#### Acceso a Colonias
```javascript
// Verificar permisos de usuario
{
  "method": "colony_access_check",
  "params": {
    "colonia_id": 1,
    "user_id": 123
  }
}
```

### Integraci√≥n Frontend

```javascript
// Ejemplo de integraci√≥n con Vue.js
export async function alternarFechaAlimentacion(fecha, coloniaId) {
  const response = await fetch('/rpc/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': obtenerCsrfToken()
    },
    body: JSON.stringify({
      method: 'toggle_feeding_date',
      params: { date_str: fecha, colonia_id: coloniaId }
    })
  });
  
  return response.json();
}
```

## üèóÔ∏è Arquitectura del Proyecto

```
gatinos/
‚îú‚îÄ‚îÄ üêç Backend (Django)
‚îÇ   ‚îú‚îÄ‚îÄ gatinos/              # Configuraci√≥n principal del proyecto
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py       # Ajustes de Django con configuraciones de entorno
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ urls.py          # Enrutamiento de URLs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py         # Configuraci√≥n personalizada del sitio admin
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py          # Aplicaci√≥n WSGI
‚îÇ   ‚îú‚îÄ‚îÄ gatos/               # Aplicaci√≥n principal de gesti√≥n de gatos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py        # Modelos de datos (Gato, Colonia, Salud, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py         # Vistas basadas en clases con mixins
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py         # Personalizaci√≥n de interfaz admin
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rpc.py          # Endpoints de API JSON-RPC
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plots.py        # Funciones de visualizaci√≥n de datos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flows.py        # Flujos de trabajo de m√°quina de estados
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms.py        # Formularios Django
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks.py        # Tareas Celery en segundo plano
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ templates/      # Plantillas HTML
‚îÇ   ‚îú‚îÄ‚îÄ registration/        # Sistema de autenticaci√≥n de usuarios
‚îÇ   ‚îî‚îÄ‚îÄ utils/              # Utilidades compartidas
‚îú‚îÄ‚îÄ üé® Frontend (Vue.js)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.js         # Punto de entrada de la aplicaci√≥n Vue
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/     # Componentes Vue
‚îÇ   ‚îú‚îÄ‚îÄ package.json        # Dependencias Node.js
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.js     # Configuraci√≥n de Vite
‚îú‚îÄ‚îÄ üóÑÔ∏è Base de Datos
‚îÇ   ‚îî‚îÄ‚îÄ migrations/         # Migraciones del esquema de base de datos
‚îú‚îÄ‚îÄ üìÅ Archivos Est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ css/               # Hojas de estilo personalizadas
‚îÇ   ‚îú‚îÄ‚îÄ js/                # Utilidades JavaScript
‚îÇ   ‚îî‚îÄ‚îÄ images/            # Im√°genes est√°ticas
‚îî‚îÄ‚îÄ üê≥ Despliegue
    ‚îú‚îÄ‚îÄ Dockerfile         # Configuraci√≥n del contenedor
    ‚îú‚îÄ‚îÄ requirements.txt   # Dependencias Python
    ‚îî‚îÄ‚îÄ entrypoint.sh     # Script de inicio del contenedor
```

## üöÄ Despliegue

### Despliegue en Producci√≥n con Docker

```bash
# Construcci√≥n para producci√≥n
docker build -t gatinos:production .

# Ejecutar con variables de entorno
docker run -d \
  --name gatinos-app \
  -p 8000:8000 \
  -e SECRET_KEY="clave-secreta-produccion" \
  -e DEBUG=False \
  -e SQL_ENGINE="django.db.backends.postgresql" \
  -e SQL_DATABASE="gatinos_prod" \
  -e SQL_USER="gatinos_user" \
  -e SQL_PASSWORD="contrase√±a_segura" \
  -e SQL_HOST="db.ejemplo.com" \
  gatinos:production
```

### Despliegue Tradicional en Servidor

1. **Configuraci√≥n del Servidor Web (Nginx)**
   ```nginx
   server {
       listen 80;
       server_name tu-dominio.com;
       
       location /static/ {
           alias /var/www/gatinos/static/;
       }
       
       location /media/ {
           alias /var/www/gatinos/media/;
       }
       
       location / {
           proxy_pass http://127.0.0.1:8000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
       }
   }
   ```

2. **Servidor de Aplicaci√≥n (Gunicorn)**
   ```bash
   pip install gunicorn
   gunicorn --bind 0.0.0.0:8000 gatinos.wsgi:application
   ```

3. **Workers en Segundo Plano (Systemd)**
   ```ini
   # /etc/systemd/system/gatinos-celery.service
   [Unit]
   Description=Gatinos Celery Worker
   After=network.target
   
   [Service]
   Type=forking
   User=www-data
   Group=www-data
   WorkingDirectory=/var/www/gatinos
   Environment=DJANGO_SETTINGS_MODULE=gatinos.settings
   ExecStart=/var/www/gatinos/.venv/bin/celery -A gatinos worker -l info
   
   [Install]
   WantedBy=multi-user.target
   ```

### Optimizaci√≥n de Rendimiento

- **Base de Datos**: Usar PostgreSQL con pooling de conexiones
- **Cach√©**: Redis para almacenamiento de sesiones y cach√© de vistas
- **Archivos Est√°ticos**: CDN para entrega de archivos est√°ticos
- **Procesamiento de Im√°genes**: Procesamiento de tareas en segundo plano para miniaturas
- **Monitoreo**: Usar Django Debug Toolbar en desarrollo

## üß™ Desarrollo

### Est√°ndares de Calidad de C√≥digo

```bash
# Formateo y linting de Python
black .
isort .
flake8 .

# Linting del frontend
cd frontend
npm run lint
npm run format
```

### Testing

```bash
# Ejecutar tests de Django
python manage.py test

# Ejecutar tests con cobertura
coverage run --source='.' manage.py test
coverage report

# Tests del frontend (si est√°n configurados)
cd frontend
npm test
```

### Agregar Nuevas Caracter√≠sticas

1. **Modelos de Base de Datos**: Actualizar `models.py` y crear migraciones
2. **Interfaz de Administraci√≥n**: Personalizar formularios y vistas de lista del admin
3. **Endpoints API**: Agregar m√©todos RPC para integraci√≥n frontend
4. **Componentes Frontend**: Crear componentes Vue.js para interactividad
5. **Plantillas**: Dise√±ar plantillas HTML responsivas
6. **Permisos**: Definir permisos personalizados para roles de usuario

### Flujo de Trabajo de Desarrollo

```bash
# Desarrollo de caracter√≠sticas
git checkout -b feature/nuevo-seguimiento-salud
python manage.py makemigrations
python manage.py migrate
# ... desarrollar y testear ...
git commit -m "Agregar caracter√≠sticas avanzadas de seguimiento de salud"
git push origin feature/nuevo-seguimiento-salud
```

## ü§ù Contribuir

¬°Damos la bienvenida a las contribuciones! Por favor sigue estas pautas:

### Para Empezar
1. **Fork** el repositorio en GitHub
2. **Clona** tu fork localmente
3. **Crea** una rama de caracter√≠stica: `git checkout -b feature/caracteristica-increible`
4. **Realiza** tus cambios con las pruebas apropiadas
5. **Commit** con mensajes descriptivos: `git commit -m 'Agregar caracter√≠stica incre√≠ble'`
6. **Push** a tu rama: `git push origin feature/caracteristica-increible`
7. **Env√≠a** un Pull Request con descripci√≥n detallada

### Est√°ndares de C√≥digo
- **Python**: Seguir PEP 8, usar type hints donde sea aplicable
- **JavaScript**: Usar configuraci√≥n ESLint, preferir sintaxis moderna ES6+
- **Documentaci√≥n**: Actualizar README.md y agregar docstrings para nuevas funciones
- **Testing**: Agregar tests para nueva funcionalidad
- **Mensajes de Commit**: Usar formato de commit convencional

### Reporte de Problemas
- Usar GitHub Issues para reportes de bugs y solicitudes de caracter√≠sticas
- Incluir pasos detallados para reproducir problemas
- Proporcionar informaci√≥n del sistema y logs de errores
- Etiquetar issues apropiadamente (bug, mejora, documentaci√≥n)

## üìÑ Licencia

Este proyecto est√° licenciado bajo la **Licencia MIT** - ver el archivo [LICENSE](LICENSE) para detalles.

```
Copyright (c) 2024 Proyecto Gatinos

Se concede permiso, de forma gratuita, a cualquier persona que obtenga una copia
de este software y archivos de documentaci√≥n asociados (el "Software"), para tratar
el Software sin restricci√≥n, incluyendo sin limitaci√≥n los derechos
de usar, copiar, modificar, fusionar, publicar, distribuir, sublicenciar y/o vender
copias del Software...
```

## üôè Agradecimientos

- **Comunidad Django** - Por el robusto framework web
- **Equipo Vue.js** - Por la biblioteca frontend reactiva
- **Contribuidores Open Source** - Todas las incre√≠bles bibliotecas de las que dependemos
- **Voluntarios de Colonias Felinas** - Los verdaderos h√©roes que inspiraron este proyecto
- **Profesionales Veterinarios** - Por la orientaci√≥n en los requisitos de seguimiento de salud

## üìû Soporte y Comunidad

### Obtener Ayuda
- **üìö Documentaci√≥n**: Consulta este README y la documentaci√≥n en l√≠nea del c√≥digo
- **üêõ Reportes de Bugs**: Abre un issue en GitHub con informaci√≥n detallada
- **üí° Solicitudes de Caracter√≠sticas**: Usa GitHub Issues con la etiqueta "mejora"
- **üí¨ Discusiones**: √önete a nuestras discusiones comunitarias para preguntas generales

### Informaci√≥n de Contacto
- **Mantenedor del Proyecto**: [Tu Nombre](mailto:tu-email@ejemplo.com)
- **GitHub Issues**: [Reportar Problemas](https://github.com/tu-org/gatinos/issues)
- **Foro Comunitario**: [Unirse a Discusiones](https://github.com/tu-org/gatinos/discussions)

---

**Hecho con ‚ù§Ô∏è para los voluntarios de colonias felinas y los gatos que cuidan.**

*"A los ojos de un gato, todas las cosas pertenecen a los gatos." - Desconocido*
